%!PS-Adobe-3.0
%%BoundingBox: 24 24 571 818
%%Title: Advent of Code 2025 - day 3
%%For: Hackvalue
%%Creator: Anders Piniesjö
%%CreationDate: Sun Dec 07 22:29:41 2025
%%Orientation: Portrait
%%DocumentMedia: A4 595 842 0 () ()
%%EndComments

% -----------------------------------------------------------------------
%  Advent of Code 2025 in Postscript - Day 3
%  by Anders Piniesjö
%
%  Run with: ghostscript 3.ps
%  
%  -- Or print it on a Postscript printer!
% -----------------------------------------------------------------------

%% ----- Data -------

/banks_demo [
(987654321111111)
(811111111111119)
(234234234234278)
(818181911112111)
] bind def

/banks [
% <<INJECT DATA HERE>>
] bind def


%% ----- Output -------

/setup_output
{
   /stdout (%stdout) (w) file def
   /print { stdout exch writestring } bind def
   /println { print stdout (\n) writestring } bind def

   /LM   50 def      % Left margin
   /RM   578 def     % Right margin
   /TM   700 def     % Top margin
   /BM   10 def      % Bottom margin
   /fontsize 18 def  % Change this to change font-size
   /ypos TM def      % current y-position
   /lineheight fontsize def

   /font_normal /Times-Roman findfont fontsize scalefont def
   /font_bold /Times-Bold findfont fontsize scalefont def
   font_normal setfont
} def

/newline
 { currentpoint exch pop lineheight sub  % calc y-val
   BM lt                                 % check if less than bottom margin
   { showpage LM TM moveto               % New page
     /ypos TM def }
   { ypos lineheight sub                 % Go left/down
     /ypos exch def
     LM ypos moveto } ifelse
} def
   
/prtstr
 { dup stringwidth pop      % calc length of string
   currentpoint pop         % get horizontal position
   add RM gt                % sum > right margin?
   {newline} if             % if so, next line
   show 
} def

/setnormal { font_normal setfont } bind def
/setbold { font_bold setfont } bind def

%% ---- Utils ------

/is_even  % int - bool
{
   2 mod 0 eq
} bind def

/char_at  % str index -- str
{
   1 getinterval
} def

%% -----  -------

/sweep_bank   % bank start end  -- highest highest_index
{
   /end exch def
   /start exch def
   /bank exch def
   /highest 0 def
   /highest_index 0 def

   start 1 end
   {
      dup bank exch char_at cvi   % Get number at pos, converted to int  - stack: index num
      dup highest gt { dup /highest exch def 1 index /highest_index exch def } if
      pop pop
   } for
   highest highest_index
} def

/maximize_bank  % str joltlen -- highest
{
   /joltlen exch def
   /bank exch def
   /banklen bank exch def
   /i 0 def
   /banksum joltlen string def

   joltlen -1 1
   {
      /k exch def
      bank i bank length k sub sweep_bank
      /i exch def
      /m exch def
      /i i 1 add def

      banksum joltlen k sub m 1 string cvs putinterval
   } for
   banksum cvi
} def

/maximize_banks
{
   /joltlen exch def
   /banksums 0 def

   banks
   {
      joltlen maximize_bank
      /banksums exch banksums add def
   } forall 

   banksums
} def

%% ------------------------------

setup_output

2  maximize_banks /jolts_step1_sum exch def
12 maximize_banks /jolts_step2_sum exch def

LM TM moveto
setbold (Advent of Code 2025) prtstr setnormal newline newline
(- Day 3 -) prtstr 1 1 6 { pop newline } for
setbold (Result Step 1: ) prtstr setnormal jolts_step1_sum 100 string cvs prtstr newline newline
setbold (Result Step 2: ) prtstr setnormal jolts_step2_sum 100 string cvs prtstr newline

% Write to stdout as well
(\nAdvent of Code 2025  - Day 3 - Anders Piniesjö\n) println 
(Step 1: ) print jolts_step1_sum 20 string cvs println
(Step 2: ) print jolts_step2_sum 20 string cvs println
