%!PS-Adobe-3.0

% -----------------------------------------------------------------------
%    Advent of Code 2025 in Postscript - Day 1
%    by Anders Piniesj√∂
%
%    Run with: gs -dNOSAFER 1.ps
% -----------------------------------------------------------------------

/stdout (%stdout) (w) file def

/count_lines   % filename -- number of lines
{ 
   /infile exch (r) file def

   0
   { % loop
      infile 128 string readline
      { pop 1 add }
      { pop infile closefile exit } ifelse
   } loop

} def

/get_lines   % array filename -- array of lines
{ 
   /infile exch (r) file def
   /arr exch def
   /i 0 def

   { % loop
      infile 128 string readline
      {
         arr i 2 index put pop
         /i i 1 add def
      }
      { pop infile closefile exit } ifelse
   } loop
   arr
} def

/parse_turn    % string (L25, etc) - int (25) str (L)
{
   /ts exch def
   /direction ts 0 1 getinterval def
   /ticks ts 1 1 index length 1 sub getinterval def
   ticks cvi
   direction
} def

/count_turns    % int (ticks), str (direction) - int (new val)
{
   dup (L) eq 
   { 
      exch dial exch sub 100 mod 100 add 100 mod
   } if
   
   dup (R) eq 
   { 
      exch dial exch add 100 mod
   } if
   exch pop % pop direction
} def

/step_1
{
   /dial 50 def
   /zerocount 0 def

   0 1 input_array length 1 sub
   { % for
      turns exch get
      parse_turn
      count_turns
      /dial exch def

      dial 0 eq { /zerocount zerocount 1 add def } if
   } for

   /result_step_1 zerocount def
} def


/count_passes    % int (ticks), str (direction) - int (new val)
{
   /dir exch def
   /ticks exch def

   dir (L) eq 
   { 
      dial ticks sub 100 div ceiling dial 100 div ceiling sub abs % leaving 0-passes on stack
      dial ticks sub 100 mod 100 add 100 mod
   } if
   
   dir (R) eq 
   { 
      dial ticks add 100 div floor dial 100 div floor sub abs % leaving 0-passes on stack
      dial ticks add 100 mod
   } if
} def

/step_2
{
   /dial 50 def
   /zerocount 0 def

   0 1 input_array length 1 sub
   { % for
      turns exch get
      parse_turn
      count_passes

      /dial exch def
      /zerocount exch zerocount add def
   } for

   /result_step_2 zerocount def
} def

% Read input file
/input_file (input.txt) def

input_file count_lines
/input_array exch array def

input_array input_file get_lines 
/turns exch def

step_1
step_2

/Times findfont 18 scalefont setfont

40 700 moveto
(Advent of Code 2025) show

40 650 moveto
(- Day 1 -) show

40 540 moveto
(Result Step 1: ) show
result_step_1 10 string cvs show

40 510 moveto
(Result Step 2: ) show
result_step_2 10 string cvs show

%quit