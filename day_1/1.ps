%!PS-Adobe-3.0
%%BoundingBox: 24 24 571 818
%%Title: Advent of Code 2025 - day 1
%%For: Hackvalue
%%Creator: Anders Piniesjö
%%CreationDate: Fri Dec 05 22:29:41 2025
%%Orientation: Portrait
%%DocumentMedia: A4 595 842 0 () ()
%%EndComments

% -----------------------------------------------------------------------
%  Advent of Code 2025 in Postscript - Day 1
%  by Anders Piniesjö
%
%  Run with: ghostscript -dNOSAFER 1.ps
%
%  Note: "-dNOSAFER" is needed to make Ghostscript to allow file access.
% -----------------------------------------------------------------------



%% ----- Output -------

/setup_output
{
   /stdout (%stdout) (w) file def
   /print { stdout exch writestring } bind def
   /println { print stdout (\n) writestring } bind def

   /LM   50 def      % Left margin
   /RM   578 def     % Right margin
   /TM   700 def     % Top margin
   /BM   10 def      % Bottom margin
   /fontsize 18 def  % Change this to change font-size
   /ypos TM def      % current y-position
   /lineheight fontsize def

   /font_normal /Times-Roman findfont fontsize scalefont def
   /font_bold /Times-Bold findfont fontsize scalefont def
   font_normal setfont
} def

/newline
 { currentpoint exch pop lineheight sub  % calc y-val
   BM lt                                 % check if less than bottom margin
   { showpage LM TM moveto               % New page
     /ypos TM def }
   { ypos lineheight sub                 % Go left/down
     /ypos exch def
     LM ypos moveto } ifelse
} def
   
/prtstr
 { dup stringwidth pop      % calc length of string
   currentpoint pop         % get horizontal position
   add RM gt                % sum > right margin?
   {newline} if             % if so, next line
   show 
} def

/setnormal { font_normal setfont } bind def
/setbold { font_bold setfont } bind def


/count_lines   % filename -- number of lines
{ 
   /infile exch (r) file def

   0
   { % loop
      infile 128 string readline
      { pop 1 add }
      { pop infile closefile exit } ifelse
   } loop

} def

/get_lines   % array filename -- array of lines
{ 
   /infile exch (r) file def
   /arr exch def
   /i 0 def

   { % loop
      infile 128 string readline
      {
         arr i 2 index put pop
         /i i 1 add def
      }
      { pop infile closefile exit } ifelse
   } loop
   arr
} def

/parse_turn    % string (L25, etc) - int (25) str (L)
{
   /ts exch def
   /direction ts 0 1 getinterval def
   /ticks ts 1 1 index length 1 sub getinterval def
   ticks cvi
   direction
} def

%% ----- step 1 -------

/count_turns    % int (ticks), str (direction) - int (new val)
{
   dup (L) eq 
   { 
      exch dial exch sub 100 mod 100 add 100 mod
   } if
   
   dup (R) eq 
   { 
      exch dial exch add 100 mod
   } if
   exch pop % pop direction
} def

/step_1
{
   /dial 50 def
   /zerocount 0 def

   0 1 input_array length 1 sub
   { % for
      turns exch get
      parse_turn
      count_turns
      /dial exch def

      dial 0 eq { /zerocount zerocount 1 add def } if
   } for

   /result_step_1 zerocount def
} def

%% ----- step 2 -------

/count_passes    % int (ticks), str (direction) - int (new val)
{
   /dir exch def
   /ticks exch def

   dir (L) eq 
   { 
      dial ticks sub 100 div ceiling dial 100 div ceiling sub abs % leaving 0-passes on stack
      dial ticks sub 100 mod 100 add 100 mod
   } if
   
   dir (R) eq 
   { 
      dial ticks add 100 div floor dial 100 div floor sub abs % leaving 0-passes on stack
      dial ticks add 100 mod
   } if
} def

/step_2
{
   /dial 50 def
   /zerocount 0 def

   0 1 input_array length 1 sub
   { % for
      turns exch get
      parse_turn
      count_passes

      /dial exch def
      /zerocount exch zerocount add def
   } for

   /result_step_2 zerocount cvi def
} def

%% ------------------------------

% Read input file
/input_file (input.txt) def

input_file count_lines
/input_array exch array def

input_array input_file get_lines 
/turns exch def

setup_output

step_1
step_2

LM TM moveto
setbold (Advent of Code 2025) prtstr setnormal newline newline
(- Day 2 -) prtstr 1 1 6 { pop newline } for
setbold (Result Step 1: ) prtstr setnormal result_step_1 100 string cvs prtstr newline newline
setbold (Result Step 2: ) prtstr setnormal result_step_2 100 string cvs prtstr newline

% Write to stdout as well
(\nAdvent of Code 2025  - Day 1 - Anders Piniesjö\n) println 
(Step 1: ) print result_step_1 20 string cvs println
(Step 2: ) print result_step_2 20 string cvs println

%quit